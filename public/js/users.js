function showConfirmAlert(t,e){return Swal.fire({confirmButtonText:"Yes",cancelButtonText:"No",showCancelButton:!0,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,title:t,text:e,icon:"warning",width:"300px",customClass:{confirmButton:"btn bg-success swal-okay-button",cancelButton:"btn bg-danger swal-okay-button",title:"swal-title",content:"swal-subtitle"}})}function showSuccessAlert(t,e){Swal.fire({confirmButtonText:"Okay",allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,title:t,html:e,icon:"success",width:"300px",customClass:{confirmButton:"btn bg-success swal-okay-button",title:"swal-title",content:"swal-subtitle"}})}function showErrorAlert(t,e){Swal.fire({confirmButtonText:"Okay",allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,title:t,html:e,icon:"error",width:"300px",customClass:{confirmButton:"btn bg-danger swal-okay-button",title:"swal-title",content:"swal-subtitle"}})}function showInfoAlert(t,e){Swal.fire({confirmButtonText:"Okay",allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,title:t,html:e,icon:"info",width:"300px",customClass:{confirmButton:"btn swal-okay-button",title:"swal-title",content:"swal-subtitle"}})}function showWarningAlert(t,e){Swal.fire({confirmButtonText:"Okay",allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,title:t,html:e,icon:"warning",width:"300px",customClass:{confirmButton:"btn btn-warn swal-okay-button",title:"swal-title",content:"swal-subtitle-validation"}})}function showLoader(t,e){Swal.fire({allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,title:t,html:e,width:"300px",onBeforeOpen:()=>{Swal.showLoading()}})}function showHttpErrorAlert(t){0==t.status?showErrorAlert("Error","Check your internet connection and try again"):500==t.status?showErrorAlert("Internal server error",t.responseJSON.message?t.responseJSON.message:t.responseJSON):404==t.status?showErrorAlert("Error 404","The data you requested was not found"):showErrorAlert("Unknown Error","Oopps... Something went wrong")}function showValidationErrorAlert(t,e){e=e.responseJSON;let n="<ul>";for(const a of t)if(void 0!==e[a])for(const t of e[a])n+=`<li>${t}</li>`;showWarningAlert("Warning",n+="</ul>")}function showModal(t,e,n="350px"){Swal.fire({showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,title:t,html:e,width:n,customClass:{title:"swal-title",content:"swal-subtitle"}})}$(document).ready(function(){var t=null;function e(t,e){$(".sidepanel").removeClass("sidepanel-hidden").addClass("sidepanel-shown").attr("id",t),$("#title").html(e),$("#overlay").removeAttr("hidden"),$("html").css("overflow","hidden")}$(".add_new_btn").click(function(){e("users_add_form","Add new user")}),$(document).on("click","#upload-btn",function(){$("#_image_input").click()}),$(document).on("submit","#users_add_form",function(t){t.preventDefault();let e=$(this).serializeArray();showLoader("Saving","Please wait..."),ajaxCall("/backend/users",e,"POST").done(t=>{showSuccessAlert("Success","Successfully added new user"),$("#users").append(`\n\t\t\t\t<div class="border shadow row m-0 mb-4 bg-light parent-${t.id}">\n\t\t\t\t\t<div class="col-md-12 p-3">\n\t\t\t\t\t\t<span style="float: right !important; font-size: 1.2em !important; cursor: pointer">\n\t\t\t\t\t\t\t<i class="fa fa-pencil text-gold text-gold-hover edit-btn" value="${t.id}" title="edit"></i>\n\t\t\t\t\t\t\t&nbsp;&nbsp;\n\t\t\t\t\t\t\t<i class="fa fa-trash text-gold text-gold-hover delete-btn" value="${t.id}" title="delete"></i>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<h5 class="text-gold user-name">${t.name}</h5>\n\t\t\t\t\t\t\t<i class="user-level">${t.access_level}</i><br>\n\t\t\t\t\t\t\t<span class="user-email">${t.email}</span><br>\n\t\t\t\t\t\t\t<span class="user-address">${t.address}</span><br>\n\t\t\t\t\t\t\t<p class="smaller text-gold">\n\t\t\t\t\t\t\t\tLast updated by:<br>\n\t\t\t\t\t\t\t\t<span class="user-updated">\n\t\t\t\t\t\t\t\t\t${t.updated_by}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`),$("#close_panel").click()}).fail(t=>{showHttpErrorAlert(t)})}),$(document).on("click",".edit-btn",function(){t=$(this).attr("value"),showLoader("Loading","Please wait..."),$.get(`/backend/users/${t}`,function(t){Swal.close(),$("#first_name").val(t.first_name),$("#middle_name").val(t.middle_name),$("#last_name").val(t.last_name),$("#extension").val(t.extension),$("#email").val(t.email),$("#address").val(t.address),$("#access_level_id").val(t.access_level_id),e("users_edit_form","Edit User")}).fail(t=>{showHttpErrorAlert(t)})}),$(document).on("submit","#users_edit_form",function(e){e.preventDefault();let n=$(this).serializeArray();showLoader("Updating","Please wait..."),ajaxCall(`/backend/users/${t}`,n,"PUT").done(t=>{$(`.parent-${t.id}`).find(".user-name").html(t.name),$(`.parent-${t.id}`).find(".user-email").html(t.email),$(`.parent-${t.id}`).find(".user-address").html(t.address),$(`.parent-${t.id}`).find(".user-level").html(t.access_level),$(`.parent-${t.id}`).find(".user-updated").html(t.updated_by),$("#close_panel").click(),showSuccessAlert("Success","User was successfully updated!")}).fail(t=>{showHttpErrorAlert(t)})}),$(document).on("click",".delete-btn",function(){t=$(this).attr("value"),parent=$(`.parent-${t}`),showConfirmAlert("Warning","Are you sure to delete this user?").then(e=>{e.value&&(showLoader("Deleting","Please wait..."),ajaxCall(`/backend/users/${t}`,{_token:_token},"DELETE").done(t=>{showSuccessAlert("Success","User was successfully deleted"),parent.fadeOut("fast",function(){$(this).remove()})}).fail(t=>{showHttpErrorAlert(t)}))})}),$("#close_panel").click(function(){$(".sidepanel").removeClass("sidepanel-shown").addClass("sidepanel-hidden"),$("#overlay").attr("hidden",""),$("html").css("overflow","auto"),setTimeout(()=>{$(".user_form")[0].reset(),$("#_image").attr("src","/img/no-image.png")},600)})});var _token=$('meta[name="csrf-token"]').attr("content");function findObjectBySubKey(t,e,n,a){for(var l=0;l<t.length;l++)if(t[l][e][n]==a)return l;return null}function multiArraySort(t,e){t.sort(function(t,n){const a=t[e],l=n[e];let s=0;return a>l?s=-1:a<l&&(s=1),s})}function ajaxCall(t,e,n){return $.ajax({url:t,data:e,type:n})}function ajaxCall2(t,e,n){return $.ajax({url:t,data:e,type:n,cache:!1,contentType:!1,processData:!1})}function getTime(){date=new Date;var t=date.getHours(),e=date.getMinutes();return(t=t<10?"0"+t:t)+":"+(e=e<10?"0"+e:e)}function getDate(){let t=new Date;return`${t.getFullYear()}-${t.getMonth()<10?"0"+t.getMonth():t.getMonth()}-${t.getDate()<10?"0"+t.getDate():t.getDate()}`}$(function(){$('[data-toggle="tooltip"]').tooltip()});
